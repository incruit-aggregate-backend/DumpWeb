<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dispatch.dump.commonModule.db.mapper.DailyReportStep5Mapper">

    <!--차계부 내용 저장-->
    <insert id="insertDailyReportStep5" parameterType="DailyReportStep5">
        <!--idx 자동->따로 작성 X-->
        insert into
            tdrive
            (driveID, carNo, drvDate, lastKm, drvClub, useAmt, useOil, drvRem, chk2)
        values
            (#{driveID}, #{carNo}, #{drvDate}, #{lastKm}, #{drvClub}, #{useAmt}, #{useOil}, #{drvRem}, #{chk2})
    </insert>



<!--    &lt;!&ndash;제출처 정보 상세 조회&ndash;&gt;-->
<!--    &lt;!&ndash;제출담당자 휴대폰 번호로 제출처와 담당자 이름 조회&ndash;&gt;-->
<!--    <select id="findDailyReportMainBycarSubmitTel">-->
<!--        select sheetID, DATE_FORMAT(date, '%y-%m-%d') as date, carSubmit, salesman from tSheet where carSubmitTel=#{carSubmitTel}-->
<!--    </select>-->

<!--    <select id="findDailyReportList" resultType="DailyReportStep3Main" parameterType="DailyReportStep3Main">-->
<!--        select sheetID, DATE_FORMAT(date, '%m/%d') as date, carSubmit, salesman from tSheet where CarNo=#{carNo}-->
<!--        ORDER BY carSubmit, date-->
<!--    </select>-->

    <!--차계부 수정-->
    <!--조회한 정보가 과거 정보일 때, 수정 But 기존정보와 동일하다면 수정 불가능(and가 아닌 or조건) -->
    <update id="updateDailyReportStep5" parameterType="DailyReportStep5">
        update tdrive
        <set>
            <if test="carSubmit !=null and carSubmit != carSubmit">
                carSubmit=#{carSubmit},
            </if>
            <if test="carSubmitTel !=null and carSubmitTel != carSubmitTel">
                carSubmitTel=#{carSubmitTel},
            </if>
            <if test="salesman !=null and salesman != salesman">
                salesman=#{salesman}
            </if>
        </set>
        where carSubmitTel=#{carSubmitTel}
        and (carSubmit != carSubmit or carSubmitTel != carSubmitTel or salesman != salesman)
    </update>


</mapper>